config system global
    set hostname "firewall_policy"
end
config system interface
    edit "port1"
        set vdom "root"
        set ip 10.0.1.1/24
    next
    edit port2
        set vdom "root"
        set ip 10.0.2.1/24
    next
end
config firewall service custom
    edit "custom_tcp_11"
        set tcp-portrange 11
    next
    edit "custom_tcp_11_to_12"
        set tcp-portrange 11:12
    next
end
config firewall policy
    # Disabled rule should be ignored
    edit 0
        set action deny
        set srcintf port1
        set dstintf port2
        set srcaddr addr1
        set dstaddr addr2
        set service custom_tcp_11
        set status disable
    next
    edit 4294967294
        set name "longest allowed firewall policy nam"
        set srcintf port1
        set dstintf port2
        set srcaddr addr1
        set dstaddr addr2
        set service custom_tcp_11_to_12
        set comments "firewall policy comments"
    next
    # Number doesn't indicate order, just a unique identifier
    edit 1
        set action allow
        set srcintf port1
        set dstintf port2
        # Multiple items doesn't work yet...
        # set dstintf port1 port2
        set srcaddr addr1
        set dstaddr addr2
        set service custom_tcp_11
        set status enable
    next
    # TODO handle append lines
end
