name: Vulnerability Scan
on:
  schedule:
    - cron: '0 15 * * *'  # 8AM Pacific; daily
  workflow_dispatch:
    inputs:
      manual_tag:
        description: "Specific Docker image tag to scan"
        type: string
        required: true

jobs:
  scan_latest:
    if: github.event_name != 'workflow_dispatch'
    uses: ./.github/workflows/reusable-vulnerability-scan.yml
    with:
      tag: 'latest'
  scan_manual:
    if: github.event_name == 'workflow_dispatch'
    uses: ./.github/workflows/reusable-vulnerability-scan.yml
    with:
      tag: "${{ github.event.inputs.manual_tag }}"
